!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.jspdfDynamicTables=e():t.jspdfDynamicTables=e()}(this,()=>(()=>{"use strict";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{RenderError:()=>r,TableError:()=>o,ValidationError:()=>n,autoTable:()=>s});class o extends Error{constructor(t,e){super(t),this.code=e,this.name="TableError"}}class n extends o{constructor(t){super(t,"VALIDATION_ERROR")}}class r extends o{constructor(t){super(t,"RENDER_ERROR")}}function i(t,e){if("object"!=typeof t)throw new n(`${e} must be an object`);const{fillColor:o,textColor:r}=t;void 0!==o&&a(o,`${e}.fillColor`),void 0!==r&&a(r,`${e}.textColor`)}function a(t,e){if(!Array.isArray(t)||3!==t.length)throw new n(`${e} must be an array of 3 numbers [r, g, b]`);t.forEach((t,o)=>{if("number"!=typeof t||t<0||t>255)throw new n(`${e}[${o}] must be a number between 0 and 255`)})}function l(t,e){var o,n;try{return t.getTextWidth(e)}catch(r){console.warn(`Failed to get text width for "${e}":`,r);const i=(null===(n=null===(o=t.internal)||void 0===o?void 0:o.getFontSize)||void 0===n?void 0:n.call(o))||10;return e.length*i*.6}}function s(t,e,a,s={}){var c,d;try{!function(t){if(!t)throw new n("Document parameter is required");if("object"!=typeof t||"function"!=typeof t.text||"function"!=typeof t.rect)throw new n("Document must be a valid jsPDF instance")}(t),function(t){if(!Array.isArray(t))throw new n("Columns must be an array");if(0===t.length)throw new n("At least one column is required");t.forEach((t,e)=>{if(!t||"object"!=typeof t)throw new n(`Column at index ${e} must be an object`);if("string"!=typeof t.header||""===t.header.trim())throw new n(`Column at index ${e} must have a non-empty header string`);if("string"!=typeof t.dataKey||""===t.dataKey.trim())throw new n(`Column at index ${e} must have a non-empty dataKey string`)})}(e),function(t){if(!Array.isArray(t))throw new n("Data must be an array")}(a),function(t){if(t&&"object"!=typeof t)throw new n("Options must be an object");if(t){const{startY:e,margin:o,pageBreak:r,theme:a,styles:l,headerStyles:s,bodyStyles:c}=t;if(void 0!==e&&("number"!=typeof e||e<0))throw new n("startY must be a non-negative number");if(void 0!==o&&("number"!=typeof o||o<0))throw new n("margin must be a non-negative number");if(void 0!==r&&!["auto","avoid","always"].includes(r))throw new n('pageBreak must be "auto", "avoid", or "always"');if(void 0!==a&&!["striped","grid","plain","minimal"].includes(a))throw new n('theme must be "striped", "grid", "plain", or "minimal"');void 0!==l&&function(t,e){if("object"!=typeof t)throw new n(`${e} must be an object`);const{font:o,fontStyle:r,fontSize:i,cellPadding:a}=t;if(void 0!==o&&"string"!=typeof o)throw new n(`${e}.font must be a string`);if(void 0!==r&&!["normal","bold","italic","bolditalic"].includes(r))throw new n(`${e}.fontStyle must be "normal", "bold", "italic", or "bolditalic"`);if(void 0!==i&&("number"!=typeof i||i<=0))throw new n(`${e}.fontSize must be a positive number`);if(void 0!==a&&("number"!=typeof a||a<0))throw new n(`${e}.cellPadding must be a non-negative number`)}(l,"styles"),void 0!==s&&i(s,"headerStyles"),void 0!==c&&i(c,"bodyStyles")}}(s);const{startY:f=20,margin:u=10,pageBreak:h="auto",theme:b="striped",tableWidth:g="auto",columnWidthMode:m="auto",showHeader:y=!0,showBorders:p=!0,alternateRowColors:w=!0,styles:S={},headerStyles:j={},bodyStyles:v={},alternateRowStyles:C={},borderStyles:x={},rowHeight:O="auto",headerHeight:E="auto"}=s,$=function(t){return"number"==typeof t?{top:t,right:t,bottom:t,left:t}:{top:t.top||10,right:t.right||10,bottom:t.bottom||10,left:t.left||10}}(u),P={font:"helvetica",fontStyle:"normal",fontSize:10,cellPadding:4,lineHeight:1.2},z=Object.assign(Object.assign({},P),{fontStyle:"bold",fillColor:[240,240,240],textColor:[0,0,0],borderColor:[200,200,200]}),F=Object.assign(Object.assign({},P),{fillColor:[255,255,255],textColor:[0,0,0],borderColor:[220,220,220]}),R=Object.assign(Object.assign({},P),{fillColor:[248,248,248],textColor:[0,0,0]}),W=p?{top:!0,right:!0,bottom:!0,left:!0,horizontal:!0,vertical:!0}:{},T=Object.assign(Object.assign({},P),S),A=Object.assign(Object.assign({},z),j),D=Object.assign(Object.assign({},F),v),M=Object.assign(Object.assign({},R),C),H=Object.assign(Object.assign({},W),x),K=t.internal.pageSize.width,N=t.internal.pageSize.height;let L=K-$.left-$.right;if("number"==typeof g)L=Math.min(g,L);else if("string"==typeof g&&g.endsWith("%")){const V=parseFloat(g)/100;L=(K-$.left-$.right)*V}t.setFont(T.font,T.fontStyle),t.setFontSize(T.fontSize);const _=function(t,e,o,n,r,i){const a=e.length;if("equal"===r){const t=n/a;return e.map(()=>t)}const s=e.map((e,r)=>{const a=l(t,e.header);let s=0;if(o.length>0){const n=o.map(o=>{const n=o[e.dataKey],r=null!=n?String(n):"";return l(t,r)}).filter(t=>!isNaN(t)&&isFinite(t));s=n.length>0?Math.max(...n):0}let c=Math.max(a,s)+2*(i.cellPadding||2);return e.width&&"number"==typeof e.width?c=e.width:e.width&&"string"==typeof e.width&&(c=function(t,e){return"number"==typeof t?t:"string"==typeof t&&t.endsWith("%")?e*(parseFloat(t)/100):0}(e.width,n)),e.minWidth&&(c=Math.max(c,e.minWidth)),e.maxWidth&&(c=Math.min(c,e.maxWidth)),c});if("content"===r)return s;const c=s.reduce((t,e)=>t+e,0);if(c<=n){const t=n/c;return s.map(e=>e*t)}{const t=n/c;return s.map(e=>e*t)}}(t,e,a,L,m,T),B=_.reduce((t,e)=>t+e,0);B>L&&console.warn(`Table width (${B}) exceeds available width (${L}). Columns will be scaled down.`);let Y=f;const k=$.left+(L-B)/2;function q(e,o,n,r,i,a,s,c=!1){try{if(t.setFont(a.font,a.fontStyle),t.setFontSize(a.fontSize),a.fillColor&&(t.setFillColor(a.fillColor[0],a.fillColor[1],a.fillColor[2]),t.rect(o,n,r,i,"F")),p&&H){const e=a.borderColor||[0,0,0];!function(t,e,o,n,r,i,a=[0,0,0]){if(t.setDrawColor(a[0],a[1],a[2]),i.top){const r="number"==typeof i.top?i.top:.1;t.setLineWidth(r),t.line(e,o,e+n,o)}if(i.right){const a="number"==typeof i.right?i.right:.1;t.setLineWidth(a),t.line(e+n,o,e+n,o+r)}if(i.bottom){const a="number"==typeof i.bottom?i.bottom:.1;t.setLineWidth(a),t.line(e,o+r,e+n,o+r)}if(i.left){const n="number"==typeof i.left?i.left:.1;t.setLineWidth(n),t.line(e,o,e,o+r)}}(t,o,n,r,i,H,e)}const d=r-2*a.cellPadding,f=s.wrap?function(t,e,o){if(!e||o<=0)return[e||""];const n=e.toString().split(" "),r=[];let i="";for(const e of n){const n=i?`${i} ${e}`:e;l(t,n)<=o?i=n:i?(r.push(i),i=e):r.push(e)}return i&&r.push(i),r.length>0?r:[""]}(t,e,d,a.fontSize):[e];a.textColor&&t.setTextColor(a.textColor[0],a.textColor[1],a.textColor[2]);const u=a.fontSize*(a.lineHeight||1.2),h=n+(i-f.length*u)/2+.8*u;return f.forEach((e,n)=>{const i=l(t,e),d=c&&s.headerAlign||s.align,f=o+function(t,e,o,n){switch(t){case"center":return(e-o)/2;case"right":return e-o-n;default:return n}}(d,r,i,a.cellPadding),b=h+n*u;t.text(e,f,b)}),f.length*u}catch(t){return console.error("Error drawing cell:",t),a.fontSize*(a.lineHeight||1.2)}}function U(){if(!y)return 0;try{const t="number"==typeof E?E:A.fontSize+2*A.cellPadding;let o=k,n=t;return e.forEach((e,r)=>{const i=_[r],a=q(e.header,o,Y,i,t,A,e,!0);n=Math.max(n,a+2*A.cellPadding),o+=i}),Y+=n,n}catch(t){throw new r(`Failed to draw table header: ${t instanceof Error?t.message:String(t)}`)}}function I(o,n){try{const i="number"==typeof O?O:T.fontSize+2*T.cellPadding;if("auto"===h&&Y+i>N-$.bottom)try{t.addPage(),Y=$.top,y&&U()}catch(t){throw console.error("Error adding new page:",t),new r(`Failed to add new page: ${t instanceof Error?t.message:String(t)}`)}let a=D;w&&n%2!=0&&(a=Object.assign(Object.assign({},D),M)),"striped"===b&&n%2!=0?a=Object.assign(Object.assign({},a),{fillColor:M.fillColor||[248,248,248]}):"minimal"===b&&(a=Object.assign(Object.assign({},a),{fillColor:[255,255,255],borderColor:[240,240,240]}));let l=k,s=i;return e.forEach((t,e)=>{try{const n=_[e],r=o&&void 0!==o[t.dataKey]?o[t.dataKey]:"",c=q(null!==r?String(r):"",l,Y,n,i,a,t,!1);s=Math.max(s,c+2*a.cellPadding),l+=n}catch(o){console.error(`Error drawing cell for column "${t.header}" at row ${n}:`,o),l+=_[e]||50}}),Y+=s,s}catch(t){console.error(`Error drawing row ${n}:`,t);const e=T.fontSize+2*T.cellPadding;return Y+=e,e}}try{return U(),a.length>0&&a.forEach((t,e)=>{try{I(t,e)}catch(t){console.error(`Error processing row ${e}:`,t)}}),{finalY:Y,tableWidth:B,tableHeight:Y-f,pageCount:(null===(d=null===(c=t.internal)||void 0===c?void 0:c.getNumberOfPages)||void 0===d?void 0:d.call(c))||1}}catch(X){throw new r(`Failed to render table: ${X instanceof Error?X.message:String(X)}`)}}catch(G){if(G instanceof o)throw G;throw console.error("Unexpected error in autoTable:",G),new o(`Unexpected error: ${G instanceof Error?G.message:String(G)}`,"UNEXPECTED_ERROR")}}return e})());